{% extends 'base.html' %}
{% block content %}

<p id="path" class="text-muted text-wrap px-3 mt-2 mb-2"></p>
{% if item_list %}
<div id="div" class="list-group">
    {% for item in item_list %}
    <button type="button" class="list-group-item list-group-item-action" onclick="update(this)"><i
            class="bi bi-disc pr-2"></i>{{item}}</button>
    {% endfor %}
</div>
<script>
    function update(button) {
        var curr = $(path).text();
        var item = $(button).text();
        if (curr == "") {
            curr = item;
        } else {
            if (item == "..") {
                curr = curr.split("/").slice(0, -1).join("/");
            } else {
                curr = curr + "/" + item;
            }
        }

        $.ajax({
            'url': '/update',
            'type': 'get',
            'data': { "path": curr },
            'datatype': "json",
            'success': function (data) {
                var item_list = data['item_list'].toString();
                var items = item_list.split(",");
                var html = "";
                items.forEach(item => {
                    html = html + "<button type=\"button\" class=\"list-group-item list-group-item-action\" onclick=\"update(this)\">" + item + "</button>"
                });
                $(div).html(html);
                $(path).text(curr);
            }
        })
    }
</script>
{% endif%}

{% endblock %}